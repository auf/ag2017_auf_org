{% extends "gestion/base.html" %}
{% block title %}Élections - Candidatures - AG2017{% endblock %}
{% block extrahead %}
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/jquery.form/4.0.1/jquery.form.min.js" integrity="sha384-MSBAlvUdugJfNRlgXmRfwPbw7SNanf6IaKgQBi1ajJdWoZ9oUYhxC79B5n4gp3y5" crossorigin="anonymous"></script>
{% endblock %}
{% block breadcrumbs %}
  <div class="breadcrumbs">
    <a href="{% url "tableau_de_bord" %}">Accueil</a>&rsaquo;
    <a href="{% url "accueil_elections" %}">Élections</a>&rsaquo;
    Candidatures
  </div>
{% endblock %}
{% block content %}
  <div id="form-candidatures">
  {% include "elections/candidatures_form.html" %}

  </div>

{% endblock %}

{% block js_initializations %}
<script>
  function submit_form() {
    var form = $('form');
    form.submit();
    $('input,select').prop('disabled', 'disabled');
  }

  function form_changed(event) {
    event.stopPropagation();
    var form = $('form');
    var target = $(event.target);
    if (target.attr('type') == 'radio') {
      var tr = target.closest('tr');
      var suppleant_select = tr.find('.js-select-suppleant');
      var suppleant_radio = tr.find('input[type="radio"][value="S"]');
      suppleant_select.toggle(suppleant_radio.is(':checked'));
      if (target.is(':checked') && !target.is(suppleant_radio)) {
        submit_form();
      }
    }
    else {
      submit_form();
    }
  }

  function init_form() {
    var form = $('form');
    form.ajaxForm({
      target: '#form-candidatures form',
      success: init_form
    });
    form.find('input,select').change(form_changed);

  }
  function init() {
    init_form();
  }
  $(init);

</script>
  {% endblock %}